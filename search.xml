<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>差分基础</title>
      <link href="/chafen/"/>
      <url>/chafen/</url>
      
        <content type="html"><![CDATA[<h2 id="Warning：本文可能存在通篇胡说或抄袭现象，请非战斗人员尽快撤离"><a href="#Warning：本文可能存在通篇胡说或抄袭现象，请非战斗人员尽快撤离" class="headerlink" title="Warning：本文可能存在通篇胡说或抄袭现象，请非战斗人员尽快撤离"></a>Warning：本文可能存在通篇胡说或抄袭现象，请非战斗人员尽快撤离</h2><h3 id="关于差分"><a href="#关于差分" class="headerlink" title="关于差分"></a>关于差分</h3><p>在神怜看来，差分——至少是神怜如今学习到的基础部分——其核心在于对“差”的维护上<br>具体概念请自行baidu<del>因为神怜并不会</del><br>对于一个正常的（维护对象）数组 <em>a</em> ,其差分数组 <em>d</em> 的构造方式为</p><blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span>;i=<span class="number">1</span>;i&lt;=num;i++)<span class="comment">//num是数组a长度//这里的数组下标从1开始</span></span><br><span class="line">d[i]=a[i]-a[i<span class="number">-1</span>];</span><br></pre></td></tr></table></figure></blockquote><p>相信大家可以发现，事实上该数组维护的就是前后2个数的差</p><p>即对应关系为</p><div class="article-bounded"><div class="article-table"><table><thead><tr><th style="text-align:center">b[1]</th><th style="text-align:center">b[2]</th><th style="text-align:center">…</th><th style="text-align:center">b[i]</th><th style="text-align:center">…</th><th style="text-align:center">b[num]</th></tr></thead><tbody><tr><td style="text-align:center">a[1]-a[0]</td><td style="text-align:center">a[2]-a[1]</td><td style="text-align:center">…</td><td style="text-align:center">a[i]-a[i-1]</td><td style="text-align:center">…</td><td style="text-align:center">a[num]-a[num-1]</td></tr></tbody></table></div></div><p>并由此易得： <em> b[1]+b[2]=a[1]-a[0]+a[2]-a[1]=a[2]-a[0] </em><br>同理可得       <em> b[1]+b[2]+b[3]=a[1]-a[0]+a[2]-a[1]+a[3]-a[2]=a[3]-a[0] </em><br>以此类推—— <em>b[1]+b[2]+…+b[n]=a[n]-a[0]</em><br>又∵ a[0]=0<br>∴ a[n]=b[1]+b[2]+…+b[n] 即若要知道 a数组中某数的值，只要查询 b数组中的前缀和即可<del>我不知道具体怎么说，就含糊一点吧……</del></p><h4 id="但是……这又有什么用呢？"><a href="#但是……这又有什么用呢？" class="headerlink" title="但是……这又有什么用呢？"></a>但是……<del>这又有什么用呢？</del></h4><p>神怜最初就是这样想的，但看到LXXgX上的一道树状数组模板题后就发现了自己的错误——区间修改+单点查询</p><h4 id="若您没有学习过树状数组相关知识，请先学习或点击此处查看神怜的另一篇blog"><a href="#若您没有学习过树状数组相关知识，请先学习或点击此处查看神怜的另一篇blog" class="headerlink" title="若您没有学习过树状数组相关知识，请先学习或点击此处查看神怜的另一篇blog"></a>若您没有学习过树状数组相关知识，请先学习或点击此处查看神怜的另一篇blog</h4><blockquote><p>某同学：既然最基础的树状数组就支持单点修改+区间查询，只要将区间修改转化为若干个单点修改，单点查询转化为头尾指针相同的区间查询就好了嘛QAQ<br>神怜：是这样说没错啊，可是……神怜还没到TLE的年纪啊</p></blockquote><p>咳咳，已知树状数组修改与查询的时间复杂度均为 $O(log(n))$ ,若按上述的方法，则区间修改时间复杂度增加至 $O(nlog(n))$ ,加上复数次数操作的操作，则近似于 $O(n^2 log(n))$ <del>神怜选择用暴力解决</del></p><p>这时就要用到上面的差分了(进入正题)<br>显然，上面介绍的差分数组 $d$ 可用于，查询第 $i$ 个数，但同时也要用于区间修改。</p><p>来看一组栗子：</p><blockquote><p>对于a[3]~a[5]中的每个数加上3</p></blockquote><p>先不急着分析如何解决这个问题本身，先看看我们实现单点查询的方式</p><p>由上面推导出的规律(还记得吗，如果记不清了可以先回去看2~3min呢……)可知，对一个数 $a[i]$ ，只要查询 $b[1]~b[n]$ 的和即前缀和，是不是感觉很熟悉？</p><p>没错，这就是最基础的树状数组的思想，只是维护对象由原数组 $a$ 改为了差分数组 $b$ ，因此自然很好实现，操作方法在此便不再赘述了</p><p>接下来转回正题——如何实现区间修改？</p><p>既然区间修改的结果——数组中数值的变化——是由区间查询体现出来的，则区间修改实际要做的事是保证区间查询的正确性</p><p>假设已经修改结束了，则查询 $a[3]$ 的结果应由 $b[1]+b[2]+b[3]$ 变为 $b[1]+b[2]+b[3]+3$ （为了叙述方便，暂时不将b数组进行实际修改，即此处的 $b$ 实际上是修改前的数组）,则 $b[1]~b[3]$ 这几个数一共比原来多了“3”<br>依此类推，查询 $a[4]$ 的结果应由 $b[1]+b[2]+b[3]+b[4]$ 变为 $b[1]+b[2]+b[3]+b[4]+3$，则 $b[1]~b[4]$ 这几个数一共也比原来多了“3”</p><p>既然 $b[1]~b[3]$ 的变化量 = $b[1]~b[4]$ 的变化量，显然，b[4]没有发生变化，并以此类推一直到b[5]——修改区间的尾指针所对应的b数组中数——都没有发生变化。</p><p>但显然，既然区间修改已经进行， $b$ 数组自然不会一成不变。</p><p>当前已知，在 $b[1]~b<a href="即区间修改的头指针所对应的b数组中数">3</a>$ 这段区间内共增加了“3”，且 原数组的 $a[1]~a[2]（即区间修改的头指针-1所对应的b数组中数）$并没有发生改变，即 $b[1]$ 不变， $b[1]+b[2]$ 不变，因此真正修改的数为 b[3]。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 知识梳理 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>哈希基础</title>
      <link href="/hash/"/>
      <url>/hash/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> 知识梳理 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>P3834 【模板】可持久化线段树 1（主席树）</title>
      <link href="/%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%96%E7%BA%BF%E6%AE%B5%E6%A0%91%201%EF%BC%88%E4%B8%BB%E5%B8%AD%E6%A0%91%EF%BC%89/"/>
      <url>/%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E5%8F%AF%E6%8C%81%E4%B9%85%E5%8C%96%E7%BA%BF%E6%AE%B5%E6%A0%91%201%EF%BC%88%E4%B8%BB%E5%B8%AD%E6%A0%91%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h3 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h3><h3 id="题目背景"><a href="#题目背景" class="headerlink" title="题目背景"></a>题目背景</h3><p>这是个非常经典的主席树入门题——静态区间第K小<br>数据已经过加强，请使用主席树。同时请注意常数优化</p><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>如题，给定N个正整数构成的序列，将对于指定的闭区间查询其区间内的第K小值。</p><h3 id="输入输出格式"><a href="#输入输出格式" class="headerlink" title="输入输出格式"></a>输入输出格式</h3><h4 id="输入格式："><a href="#输入格式：" class="headerlink" title="输入格式："></a>输入格式：</h4><p>第一行包含两个正整数N、M，分别表示序列的长度和查询的个数。<br>第二行包含N个正整数，表示这个序列各项的数字。<br>接下来M行每行包含三个整数 l, r, kl,r,k , 表示查询区间[l, r][l,r]内的第k小值。</p><h3 id="输出格式："><a href="#输出格式：" class="headerlink" title="输出格式："></a>输出格式：</h3><p>输出包含k行，每行1个正整数，依次表示每一次查询的结果</p><h3 id="输入输出样例"><a href="#输入输出样例" class="headerlink" title="输入输出样例"></a>输入输出样例</h3><blockquote><p>输入样例#1：<br>5 5<br>25957 6405 15770 26287 26465<br>2 2 1<br>3 4 1<br>4 5 1<br>1 2 2<br>4 4 1<br>输出样例#1：<br>6405<br>15770<br>26287<br>25957<br>26287</p></blockquote><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><h4 id="数据范围："><a href="#数据范围：" class="headerlink" title="数据范围："></a>数据范围：</h4><p><del>复制过来很奇怪，就算了吧……</del></p><hr><p>主席树的确对我来说是个难点<del>不像之前的某树</del>，</p><p><del>分析可能暂时要咕咕咕了……</del></p><p>先上代码吧……<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i,a,b) for (int i=(a);i&lt;=(b);++i)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> num,qu_es;</span><br><span class="line"><span class="keyword">int</span> siz;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 200010</span></span><br><span class="line"><span class="keyword">int</span> T[maxn];</span><br><span class="line"><span class="keyword">int</span> sum[maxn&lt;&lt;<span class="number">5</span>],s_la[maxn&lt;&lt;<span class="number">5</span>],s_lb[maxn&lt;&lt;<span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> la,<span class="keyword">int</span> lb)</span></span>&#123;</span><br><span class="line">cnt++;</span><br><span class="line"><span class="keyword">int</span> root=cnt;</span><br><span class="line">sum[root]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (la&lt;lb)&#123;</span><br><span class="line"><span class="keyword">int</span> mid=(la+lb)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">s_la[root]=build(la,mid);</span><br><span class="line">s_lb[root]=build(mid+<span class="number">1</span>,lb);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> pre,<span class="keyword">int</span> la,<span class="keyword">int</span> lb,<span class="keyword">int</span> x)</span></span>&#123;<span class="comment">//注意！pre表示前缀！ </span></span><br><span class="line">cnt++;</span><br><span class="line"><span class="keyword">int</span> root=cnt;</span><br><span class="line">s_la[root]=s_la[pre];s_lb[root]=s_lb[pre];sum[root]=sum[pre]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (la&lt;lb)&#123;</span><br><span class="line"><span class="keyword">int</span> mid=(la+lb)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (x&lt;=mid) s_la[root]=update(s_la[pre],la,mid,x);</span><br><span class="line"><span class="keyword">else</span> s_lb[root]=update(s_lb[pre],mid+<span class="number">1</span>,lb,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> la,<span class="keyword">int</span> lb,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (la&gt;=lb) <span class="keyword">return</span> la;</span><br><span class="line"><span class="keyword">int</span> mid=(la+lb)&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> x=sum[s_la[v]]-sum[s_la[u]];</span><br><span class="line"><span class="keyword">if</span> (x&gt;=k) <span class="keyword">return</span> query(s_la[u],s_la[v],la,mid,k);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">return</span> query(s_lb[u],s_lb[v],mid+<span class="number">1</span>,lb,k-x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> a[maxn],b[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">cnt=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;num&gt;&gt;qu_es;</span><br><span class="line">REP(i,<span class="number">1</span>,num) <span class="built_in">cin</span>&gt;&gt;a[i],b[i]=a[i];</span><br><span class="line">sort(b+<span class="number">1</span>,b+<span class="number">1</span>+num);</span><br><span class="line">siz=unique(b+<span class="number">1</span>,b+<span class="number">1</span>+num)-b<span class="number">-1</span>;</span><br><span class="line">T[<span class="number">0</span>]=build(<span class="number">1</span>,siz);</span><br><span class="line">REP(i,<span class="number">1</span>,num)&#123;</span><br><span class="line"><span class="keyword">int</span> t=lower_bound(b+<span class="number">1</span>,b+<span class="number">1</span>+siz,a[i])-b;<span class="comment">//lower_bound用法：二分查找第一个大于或等于num的数字，找到返回该数字的地址，不存在则返回end </span></span><br><span class="line">T[i]=update(T[i<span class="number">-1</span>],<span class="number">1</span>,siz,t);</span><br><span class="line">&#125;</span><br><span class="line">REP(i,<span class="number">1</span>,qu_es)&#123;</span><br><span class="line"><span class="keyword">int</span> x,y,z; <span class="built_in">cin</span>&gt;&gt;x&gt;&gt;y&gt;&gt;z;</span><br><span class="line"><span class="keyword">int</span> t=query(T[x<span class="number">-1</span>],T[y],<span class="number">1</span>,siz,z);</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;b[t]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> Luogu </tag>
            
            <tag> 模板 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>输入输出模板</title>
      <link href="/%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%A8%A1%E6%9D%BF/"/>
      <url>/%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h3 id="忘记从哪里学来的板子了，因为很常用，就发上来看一下吧……"><a href="#忘记从哪里学来的板子了，因为很常用，就发上来看一下吧……" class="headerlink" title="忘记从哪里学来的板子了，因为很常用，就发上来看一下吧……"></a>忘记从哪里学来的板子了，因为很常用，就发上来看一下吧……</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> w=<span class="number">1</span>,x=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (ch==<span class="string">'-'</span>) w=<span class="number">-1</span>;</span><br><span class="line">ch=getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;</span><br><span class="line">x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+ch-<span class="string">'0'</span>;</span><br><span class="line">ch=getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x*w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _write(<span class="keyword">int</span> x)&#123;</span><br><span class="line"><span class="keyword">if</span> (x/<span class="number">10</span>&gt;<span class="number">0</span>) _write(x/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x&lt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line">x=-x;</span><br><span class="line">&#125;</span><br><span class="line">_write(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 模板 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>P3372 【模板】线段树 1</title>
      <link href="/%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E7%BA%BF%E6%AE%B5%E6%A0%91%201/"/>
      <url>/%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E7%BA%BF%E6%AE%B5%E6%A0%91%201/</url>
      
        <content type="html"><![CDATA[<h2 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>如题，已知一个数列，你需要进行下面两种操作：<br>1.将某区间每一个数加上x<br>2.求出某区间每一个数的和</p><h4 id="输入输出格式"><a href="#输入输出格式" class="headerlink" title="输入输出格式"></a>输入输出格式</h4><h4 id="输入格式："><a href="#输入格式：" class="headerlink" title="输入格式："></a>输入格式：</h4><p>第一行包含两个整数N、M，分别表示该数列数字的个数和操作的总个数。<br>第二行包含N个用空格分隔的整数，其中第i个数字表示数列第i项的初始值。<br>接下来M行每行包含3或4个整数，表示一个操作，具体如下：<br>操作1： 格式：1 x y k 含义：将区间[x,y]内每个数加上k<br>操作2： 格式：2 x y 含义：输出区间[x,y]内每个数的和</p><h4 id="输出格式："><a href="#输出格式：" class="headerlink" title="输出格式："></a>输出格式：</h4><p>输出包含若干行整数，即为所有操作2的结果。</p><h4 id="输入输出样例"><a href="#输入输出样例" class="headerlink" title="输入输出样例"></a>输入输出样例</h4><blockquote><p>输入样例#1：<br>5 5<br>1 5 4 2 3<br>2 2 4<br>1 2 3 2<br>2 3 4<br>1 1 5 1<br>2 1 4<br>输出样例#1：<br>11<br>8<br>20</p></blockquote><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N&lt;=8，M&lt;=10<br>对于70%的数据：N&lt;=1000，M&lt;=10000<br>对于100%的数据：N&lt;=100000，M&lt;=100000<br>（数据已经过加强^_^，保证在int64/long long数据范围内）</p><hr><p>线段树其实学会很久了<del>学了就忘</del>，现在要学主席树，先再来补一发</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxpoint 100010</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> w=<span class="number">1</span>,x=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (ch==<span class="string">'-'</span>) w=<span class="number">-1</span>;</span><br><span class="line">ch=getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;</span><br><span class="line">x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+ch-<span class="string">'0'</span>;</span><br><span class="line">ch=getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x*w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _write(<span class="keyword">long</span> <span class="keyword">long</span> x)&#123;</span><br><span class="line"><span class="keyword">if</span> (x/<span class="number">10</span>&gt;<span class="number">0</span>) _write(x/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x&lt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line">x=-x;</span><br><span class="line">&#125;</span><br><span class="line">_write(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> po_int,qu_es;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> a[maxpoint];</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> val,tag;</span><br><span class="line">&#125;tree[maxpoint*<span class="number">4</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(<span class="keyword">int</span> ro_ot)</span></span>&#123;</span><br><span class="line">tree[ro_ot].val=tree[ro_ot&lt;&lt;<span class="number">1</span>].val+tree[ro_ot&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].val;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> ro_ot,<span class="keyword">long</span> <span class="keyword">long</span> la,<span class="keyword">long</span> <span class="keyword">long</span> lb)</span></span>&#123;</span><br><span class="line">tree[ro_ot].tag=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span> (la==lb) &#123;</span><br><span class="line">tree[ro_ot].val=a[la];</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> mid=(la+lb)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">build(ro_ot&lt;&lt;<span class="number">1</span>,la,mid);</span><br><span class="line">build(ro_ot&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,lb);</span><br><span class="line">push_up(ro_ot);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">taging</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> ro_ot,<span class="keyword">long</span> <span class="keyword">long</span> la,<span class="keyword">long</span> <span class="keyword">long</span> lb,<span class="keyword">long</span> <span class="keyword">long</span> val)</span></span>&#123;</span><br><span class="line">tree[ro_ot].tag+=val;</span><br><span class="line">tree[ro_ot].val+=(lb-la+<span class="number">1</span>)*val;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_down</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> ro_ot,<span class="keyword">long</span> <span class="keyword">long</span> la,<span class="keyword">long</span> <span class="keyword">long</span> lb)</span></span>&#123;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> mid=(lb+la)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">taging(ro_ot&lt;&lt;<span class="number">1</span>,la,mid,tree[ro_ot].tag);</span><br><span class="line">taging(ro_ot&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,mid+<span class="number">1</span>,lb,tree[ro_ot].tag);</span><br><span class="line">tree[ro_ot].tag=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> check_la,<span class="keyword">long</span> <span class="keyword">long</span> check_lb,<span class="keyword">long</span> <span class="keyword">long</span> la,<span class="keyword">long</span> <span class="keyword">long</span> lb,<span class="keyword">long</span> <span class="keyword">long</span> ro_ot,<span class="keyword">long</span> <span class="keyword">long</span> val)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (check_la&lt;=la&amp;&amp;check_lb&gt;=lb)&#123;</span><br><span class="line">tree[ro_ot].val+=(lb-la+<span class="number">1</span>)*val;</span><br><span class="line">tree[ro_ot].tag+=val;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> mid=(la+lb)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">push_down(ro_ot,la,lb);</span><br><span class="line"><span class="keyword">if</span> (check_la&lt;=mid) update(check_la,check_lb,la,mid,ro_ot&lt;&lt;<span class="number">1</span>,val);</span><br><span class="line"><span class="keyword">if</span> (check_lb&gt;mid)  update(check_la,check_lb,mid+<span class="number">1</span>,lb,ro_ot&lt;&lt;<span class="number">1</span>|<span class="number">1</span>,val);</span><br><span class="line">push_up(ro_ot);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">query</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> check_la,<span class="keyword">long</span> <span class="keyword">long</span> check_lb,<span class="keyword">long</span> <span class="keyword">long</span> la,<span class="keyword">long</span> <span class="keyword">long</span> lb,<span class="keyword">long</span> <span class="keyword">long</span> ro_ot)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (check_la&lt;=la&amp;&amp;check_lb&gt;=lb)&#123;</span><br><span class="line"><span class="keyword">return</span> tree[ro_ot].val;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> mid=(la+lb)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">push_down(ro_ot,la,lb);</span><br><span class="line"><span class="keyword">if</span> (check_la&lt;=mid) ans+=query(check_la,check_lb,la,mid,ro_ot&lt;&lt;<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (check_lb&gt;mid) ans+=query(check_la,check_lb,mid+<span class="number">1</span>,lb,ro_ot&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">push_up(ro_ot);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">po_int=read();qu_es=read();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=po_int;i++)</span><br><span class="line">a[i]=read();</span><br><span class="line">build(<span class="number">1</span>,<span class="number">1</span>,po_int);</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> x;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> check_la,check_lb,val;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=qu_es;i++)&#123;</span><br><span class="line">x=read();</span><br><span class="line"><span class="keyword">if</span> (x==<span class="number">1</span>)&#123;</span><br><span class="line">check_la=read();check_lb=read();val=read();</span><br><span class="line">update(check_la,check_lb,<span class="number">1</span>,po_int,<span class="number">1</span>,val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">check_la=read();check_lb=read();</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;query(check_la,check_lb,<span class="number">1</span>,po_int,<span class="number">1</span>);<span class="comment">//write(query(check_la,check_lb,1,po_int,1));</span></span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Luogu </tag>
            
            <tag> 模板 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>P3379【模板】最近公共祖先（LCA）</title>
      <link href="/%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88%EF%BC%88LCA%EF%BC%89/"/>
      <url>/%E3%80%90%E6%A8%A1%E6%9D%BF%E3%80%91%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88%EF%BC%88LCA%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p> 如题，给定一棵有根多叉树，请求出指定两个点直接最近的公共祖先。</p><h3 id="输入输出格式"><a href="#输入输出格式" class="headerlink" title="输入输出格式"></a>输入输出格式</h3><h4 id="输入格式："><a href="#输入格式：" class="headerlink" title="输入格式："></a>输入格式：</h4><p>第一行包含三个正整数N、M、S，分别表示树的结点个数、询问的个数和树根结点的序号。<br>接下来N-1行每行包含两个正整数x、y，表示x结点和y结点之间有一条直接连接的边（数据保证可以构成树）。<br>接下来M行每行包含两个正整数a、b，表示询问a结点和b结点的最近公共祖先。</p><h4 id="输出格式："><a href="#输出格式：" class="headerlink" title="输出格式："></a>输出格式：</h4><p>输出包含M行，每行包含一个正整数，依次为每一个询问的结果。</p><h3 id="输入输出样例"><a href="#输入输出样例" class="headerlink" title="输入输出样例"></a>输入输出样例</h3><p>输入样例#1：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">5 5 4</span><br><span class="line">3 1</span><br><span class="line">2 4</span><br><span class="line">5 1</span><br><span class="line">1 4</span><br><span class="line">2 4</span><br><span class="line">3 2</span><br><span class="line">3 5</span><br><span class="line">1 2</span><br><span class="line">4 5</span><br></pre></td></tr></table></figure></p><p>输出样例#1：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">4</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">4</span><br></pre></td></tr></table></figure></p><blockquote><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N&lt;=10，M&lt;=10<br>对于70%的数据：N&lt;=10000，M&lt;=10000<br>对于100%的数据：N&lt;=500000，M&lt;=500000</p></blockquote><hr><p>LCA一直以来是我比较苦恼<del>懒得看</del>的内容之一，周末抽空看了一下。</p><h2 id="Warning：本篇可能有大量假冒伪劣内容"><a href="#Warning：本篇可能有大量假冒伪劣内容" class="headerlink" title="Warning：本篇可能有大量假冒伪劣内容"></a>Warning：本篇可能有大量假冒伪劣内容</h2><p>关于变量：</p><blockquote><p>fa[site][tim]表示当前所在的数site向上跳 $2^tim$ 次后到达的数<br>lg[x]表示 $log_2(x)$ 向下取整后+1的 值 <del>QAQ不会打log</del><br>depth[site]表示当前数site的深度</p></blockquote><p>完整的Code://结合Code后才 可食用//QAQ我还是美国<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxpoint 500010</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> po_int,qu_es,ro_ot;</span><br><span class="line"><span class="keyword">int</span> tim;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> u,v,next;</span><br><span class="line">&#125;a[<span class="number">2</span>*maxpoint+<span class="number">10</span>];<span class="comment">//已知在树中边数==节点数-1，因此可以直接用maxpoint ,又因为每条边要存2遍，所以再*2 </span></span><br><span class="line"><span class="keyword">int</span> head[maxpoint];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">tim++;</span><br><span class="line">a[tim].v=v;<span class="comment">//a[tim].u=u;</span></span><br><span class="line">a[tim].next=head[u];head[u]=tim;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> depth[maxpoint];</span><br><span class="line"><span class="keyword">int</span> lg[maxpoint]; </span><br><span class="line"><span class="keyword">int</span> fa[maxpoint][<span class="number">23</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa_th)</span></span>&#123;</span><br><span class="line">depth[x]=depth[fa_th]+<span class="number">1</span>;</span><br><span class="line">fa[x][<span class="number">0</span>]=fa_th;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;i)&lt;=depth[x];i++)</span><br><span class="line">fa[x][i]=fa[fa[x][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=head[x];i;i=a[i].next)&#123;</span><br><span class="line"><span class="keyword">if</span> (a[i].v!=fa_th) dfs(a[i].v,x);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (depth[x]&lt;depth[y])</span><br><span class="line">swap(x,y);</span><br><span class="line"><span class="keyword">while</span>(depth[x]&gt;depth[y])</span><br><span class="line">x=fa[x][lg[depth[x]-depth[y]]<span class="number">-1</span>];</span><br><span class="line"><span class="keyword">if</span> (x==y)<span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k=lg[depth[x]]<span class="number">-1</span>;k&gt;=<span class="number">0</span>;k--)&#123;</span><br><span class="line"><span class="keyword">if</span> (fa[x][k]!=fa[y][k])</span><br><span class="line">x=fa[x][k],y=fa[y][k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> w=<span class="number">1</span>,x=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (ch==<span class="string">'-'</span>) w=<span class="number">-1</span>;</span><br><span class="line">ch=getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;</span><br><span class="line">x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+ch-<span class="string">'0'</span>;</span><br><span class="line">ch=getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x*w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> _write(<span class="keyword">int</span> x)&#123;</span><br><span class="line"><span class="keyword">if</span> (x/<span class="number">10</span>&gt;<span class="number">0</span>) _write(x/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x&lt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line">x=-x;</span><br><span class="line">&#125;</span><br><span class="line">_write(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//freopen("ans.txt","w",stdout);</span></span><br><span class="line"><span class="comment">//cin&gt;&gt;po_int&gt;&gt;qu_es&gt;&gt;ro_ot;</span></span><br><span class="line">po_int=read();qu_es=read();ro_ot=read();</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line">lg[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=po_int;i++)</span><br><span class="line">lg[i]=lg[i<span class="number">-1</span>]+(<span class="number">1</span>&lt;&lt;lg[i<span class="number">-1</span>]==i);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;po_int;i++)&#123;</span><br><span class="line">x=read();y=read();<span class="comment">//cin&gt;&gt;x&gt;&gt;y;</span></span><br><span class="line">add(x,y);add(y,x);</span><br><span class="line">&#125;</span><br><span class="line">dfs(ro_ot,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=qu_es;i++)&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;x&gt;&gt;y;</span><br><span class="line">write(lca(x,y)); <span class="built_in">putchar</span>(<span class="string">'\n'</span>);<span class="comment">//printf("%d\n",lca(x,y)); //cout&lt;&lt;lca(x,y)&lt;&lt;endl;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h3 id="Update-2018-10-27"><a href="#Update-2018-10-27" class="headerlink" title="Update: 2018/10/27"></a>Update: 2018/10/27</h3><p>差不多照着原来的代码打了一遍，竟然A了？？？<br><del>神怜今天比较欧？</del></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i,a,b) for (int i=(a);i&lt;=(b);++i)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REP_(i,a,b) for (int i=(a);i&gt;=(b);--i)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> w=<span class="number">1</span>,x=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> ch=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (ch==<span class="string">'-'</span>) w=<span class="number">-1</span>;</span><br><span class="line">ch=getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;</span><br><span class="line">x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+ch-<span class="string">'0'</span>;</span><br><span class="line">ch=getchar();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x*w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="keyword">void</span> _write(<span class="keyword">int</span> x)&#123;</span><br><span class="line"><span class="keyword">if</span> (x/<span class="number">10</span>&gt;<span class="number">0</span>) _write(x/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">'0'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (x&lt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'-'</span>);</span><br><span class="line">x=-x;</span><br><span class="line">&#125;</span><br><span class="line">_write(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> po_int,qu_es,num;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxpoint 500010</span></span><br><span class="line"><span class="keyword">int</span> tim,head[maxpoint];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> v,next;</span><br><span class="line">&#125;a[<span class="number">2</span>*maxpoint];</span><br><span class="line"><span class="keyword">int</span> f[maxpoint][<span class="number">29</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line"><span class="comment">//a[++tim].u=u;a[tim].v=v;</span></span><br><span class="line">a[++tim].v=v;</span><br><span class="line">a[tim].next=head[u];head[u]=tim;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> depth[maxpoint];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> root,<span class="keyword">int</span> fa_th)</span></span>&#123;</span><br><span class="line">depth[root]=depth[fa_th]+<span class="number">1</span>;</span><br><span class="line">f[root][<span class="number">0</span>]=fa_th;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;(<span class="number">1</span>&lt;&lt;i)&lt;=depth[root];++i)&#123;</span><br><span class="line">f[root][i]=f[f[root][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> v;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=head[root];i;i=a[i].next)&#123;</span><br><span class="line">v=a[i].v;</span><br><span class="line"><span class="keyword">if</span> (v!=fa_th) dfs(v,root);</span><br><span class="line"><span class="comment">//if (v==fa_th) continue;//警告！这样有奇怪的错误（因为我脸黑？） </span></span><br><span class="line"><span class="comment">//dfs(v,root);</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> lg[maxpoint];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (depth[x]&lt;depth[y]) swap(x,y);</span><br><span class="line"><span class="keyword">while</span> (depth[x]&gt;depth[y])&#123;</span><br><span class="line">x=f[x][lg[depth[x]-depth[y]]<span class="number">-1</span>];<span class="comment">//x=f[x][lg[depth[y]-depth[x]-1];</span></span><br><span class="line"><span class="comment">//警告！ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (x==y) <span class="keyword">return</span> x;</span><br><span class="line">REP_(k,lg[depth[x]]<span class="number">-1</span>,<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (f[x][k]!=f[y][k])</span><br><span class="line">x=f[x][k],y=f[y][k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">po_int=read();qu_es=read();num=read();</span><br><span class="line"><span class="keyword">int</span> x,y;</span><br><span class="line">REP(i,<span class="number">1</span>,po_int<span class="number">-1</span>)&#123;</span><br><span class="line">x=read();y=read();</span><br><span class="line">add(x,y);add(y,x);</span><br><span class="line">&#125;</span><br><span class="line">lg[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">REP(i,<span class="number">1</span>,po_int) lg[i]=lg[i<span class="number">-1</span>]+(<span class="number">1</span>&lt;&lt;lg[i<span class="number">-1</span>]==i);</span><br><span class="line">dfs(num,<span class="number">0</span>);</span><br><span class="line">REP(i,<span class="number">1</span>,qu_es)&#123;</span><br><span class="line">x=read();y=read();</span><br><span class="line">write(lca(x,y));</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Luogu </tag>
            
            <tag> 模板 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>做题记录</title>
      <link href="/history/"/>
      <url>/history/</url>
      
        <content type="html"><![CDATA[<p>这里是</p>]]></content>
      
      
      
        <tags>
            
            <tag> noip备战 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Day 0</title>
      <link href="/before-noip/"/>
      <url>/before-noip/</url>
      
        <content type="html"><![CDATA[<p>这大概是日记之类的东西……</p><p>打完第二场模拟赛，第一次A掉了T1，但教练还没公布名额分配的问题，只是先说了要停课……</p><p>希望能选上吧…</p><p>还有就是——开始努力吧……</p><p>（<a href="/post/history">做题记录</a>）</p>]]></content>
      
      
      
        <tags>
            
            <tag> noip备战 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hello World</title>
      <link href="/hello-world/"/>
      <url>/hello-world/</url>
      
        <content type="html"><![CDATA[<p>这里原本是hexo默认文档的地方，暂且删除，权当庆祝一下新博客的建成吧</p>]]></content>
      
      
      
        <tags>
            
            <tag> 未分类 </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
